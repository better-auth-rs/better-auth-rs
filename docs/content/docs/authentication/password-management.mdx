---
title: Password Management
description: Forget, reset, change, and set passwords.
---

The `PasswordManagementPlugin` provides endpoints for password reset flows and password changes.

## Setup

```rust
use better_auth::plugins::PasswordManagementPlugin;

let auth = BetterAuth::new(config)
    .database(database)
    .plugin(
        PasswordManagementPlugin::new()
            .reset_token_expiry_hours(24)
            .require_current_password(true)
    )
    .build()
    .await?;
```

### Plugin Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `reset_token_expiry_hours` | `i64` | `24` | Hours before reset token expires |
| `require_current_password` | `bool` | `true` | Require current password for changes |
| `send_email_notifications` | `bool` | `true` | Send email on password changes |

## Forget Password

Initiates a password reset flow. Requires an [email provider](/docs/concepts/configuration) to send the reset link.

```http
POST /forget-password
Content-Type: application/json
```

```json
{
  "email": "alice@example.com",
  "redirectTo": "https://example.com/reset"
}
```

### Response

```json
{
  "status": true
}
```

Always returns success regardless of whether the email exists (prevents enumeration).

## Reset Password

Completes the password reset using a token from the email link.

```http
POST /reset-password
Content-Type: application/json
```

```json
{
  "newPassword": "new_secure_password",
  "token": "reset_token_from_email"
}
```

### Response

```json
{
  "user": { ... }
}
```

| Status | Condition |
|--------|-----------|
| 400 | Token missing or expired, password too short |

## Validate Reset Token

Check if a reset token is still valid before showing the reset form.

```http
GET /reset-password/{token}
```

Returns `200` if valid, `400` if expired or invalid.

## Change Password (Authenticated)

Change password for the currently signed-in user.

```http
POST /change-password
Authorization: Bearer <token>
Content-Type: application/json
```

```json
{
  "currentPassword": "old_password",
  "newPassword": "new_password",
  "revokeOtherSessions": "true"
}
```

| Field | Required | Description |
|-------|----------|-------------|
| `currentPassword` | Yes | Current password for verification |
| `newPassword` | Yes | New password (must meet policy) |
| `revokeOtherSessions` | No | Revoke all other sessions after change |

### Response

```json
{
  "user": { ... },
  "token": "a1b2c3d4e5f6..."
}
```

## Set Password (Authenticated)

Set a password for users who signed up via OAuth and don't have one yet.

```http
POST /set-password
Authorization: Bearer <token>
Content-Type: application/json
```

```json
{
  "newPassword": "new_password"
}
```

Returns `400` if the user already has a password set.
